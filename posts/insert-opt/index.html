<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How TiDB Implements the INSERT Statement | Mini Fish</title><meta name=keywords content><meta name=description content="In the previous article &ldquo;Overview of the Insert Statement&rdquo;, the general process of the INSERT statement was introduced. This article will explain in detail the implementation of several types of INSERT statements in TiDB.
Types of INSERT Statements
In TiDB, there are the following types of INSERT statements:

INSERT
INSERT IGNORE
INSERT ON DUPLICATE KEY UPDATE
INSERT IGNORE ON DUPLICATE KEY UPDATE
REPLACE
LOAD DATA

These six statements theoretically fall under the category of INSERT statements."><meta name=author content="Jack Yu"><link rel=canonical href=https://blog.minifish.org/posts/insert-opt/><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.minifish.org/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.minifish.org/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.minifish.org/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.minifish.org/apple-touch-icon.png><link rel=mask-icon href=https://blog.minifish.org/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.minifish.org/posts/insert-opt/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-G0H8JF722Y"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-G0H8JF722Y")}</script><meta property="og:url" content="https://blog.minifish.org/posts/insert-opt/"><meta property="og:site_name" content="Mini Fish"><meta property="og:title" content="How TiDB Implements the INSERT Statement"><meta property="og:description" content="In the previous article “Overview of the Insert Statement”, the general process of the INSERT statement was introduced. This article will explain in detail the implementation of several types of INSERT statements in TiDB.
Types of INSERT Statements In TiDB, there are the following types of INSERT statements:
INSERT INSERT IGNORE INSERT ON DUPLICATE KEY UPDATE INSERT IGNORE ON DUPLICATE KEY UPDATE REPLACE LOAD DATA These six statements theoretically fall under the category of INSERT statements."><meta property="og:locale" content="en-US"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-07-11T14:18:00+08:00"><meta property="article:modified_time" content="2018-07-11T14:18:00+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="How TiDB Implements the INSERT Statement"><meta name=twitter:description content="In the previous article &ldquo;Overview of the Insert Statement&rdquo;, the general process of the INSERT statement was introduced. This article will explain in detail the implementation of several types of INSERT statements in TiDB.
Types of INSERT Statements
In TiDB, there are the following types of INSERT statements:

INSERT
INSERT IGNORE
INSERT ON DUPLICATE KEY UPDATE
INSERT IGNORE ON DUPLICATE KEY UPDATE
REPLACE
LOAD DATA

These six statements theoretically fall under the category of INSERT statements."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.minifish.org/posts/"},{"@type":"ListItem","position":2,"name":"How TiDB Implements the INSERT Statement","item":"https://blog.minifish.org/posts/insert-opt/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How TiDB Implements the INSERT Statement","name":"How TiDB Implements the INSERT Statement","description":"In the previous article \u0026ldquo;Overview of the Insert Statement\u0026rdquo;, the general process of the INSERT statement was introduced. This article will explain in detail the implementation of several types of INSERT statements in TiDB.\nTypes of INSERT Statements In TiDB, there are the following types of INSERT statements:\nINSERT INSERT IGNORE INSERT ON DUPLICATE KEY UPDATE INSERT IGNORE ON DUPLICATE KEY UPDATE REPLACE LOAD DATA These six statements theoretically fall under the category of INSERT statements.\n","keywords":[],"articleBody":"In the previous article “Overview of the Insert Statement”, the general process of the INSERT statement was introduced. This article will explain in detail the implementation of several types of INSERT statements in TiDB.\nTypes of INSERT Statements In TiDB, there are the following types of INSERT statements:\nINSERT INSERT IGNORE INSERT ON DUPLICATE KEY UPDATE INSERT IGNORE ON DUPLICATE KEY UPDATE REPLACE LOAD DATA These six statements theoretically fall under the category of INSERT statements.\nThe first type is the most common INSERT statement, which needs no further explanation.\nThe second type, INSERT IGNORE, skips the current row when encountering a unique constraint conflict (primary key conflict, unique index conflict) and logs a warning. After the execution of the statement, you can see which rows were not inserted through SHOW WARNINGS.\nThe third type, INSERT ON DUPLICATE KEY UPDATE, updates the conflicting row and then inserts the data. If the updated row conflicts with another row in the table, an error is returned.\nThe fourth type, INSERT IGNORE ON DUPLICATE KEY UPDATE, does not insert the row and displays a warning when the updated row conflicts with another row after the initial conflict.\nThe fifth type, REPLACE, deletes the conflicting row from the table and continues trying to insert data. If another conflict occurs, it continues deleting the conflicting data until there is no more conflicting data in the table, then inserts the data.\nThe last type, LOAD DATA, follows the same rule as INSERT IGNORE—it ignores conflicts. However, LOAD DATA’s purpose is to import data from a file into a table, meaning the data comes from a CSV data file.\nThis article mainly focuses on the source code implementation of the first and second types (INSERT, INSERT IGNORE), while the third and fifth types (INSERT ON DUPLICATE KEY UPDATE, REPLACE) will be introduced later. INSERT IGNORE ON DUPLICATE KEY UPDATE involves some special handling on top of INSERT ON DUPLICATE KEY UPDATE, and LOAD DATA is a special implementation of INSERT IGNORE, so they will not be detailed here.\nINSERT Statement The major difference between these various INSERT statements lies in the execution layer. We will continue with the explanation from “Overview of the Insert Statement”. If you don’t remember the previous content, feel free to refer back to the original article.\nThe execution logic of INSERT is located in executor/insert.go. In fact, the execution logic of the first four INSERT types is all in this file. Let’s first discuss the most basic INSERT.\nInsertExec is the executor implementation for INSERT, which implements the Executor interface. It performs some initialization in the Open method, executes in the Next method, and does some cleanup in the Close method.\nIn the Next method, based on whether the data is acquired through a SELECT statement (INSERT INTO … SELECT FROM), the Next process is divided into insertRows and insertRowsFromSelect. Both processes eventually enter the exec function to execute the INSERT.\nWithin the exec function, the first four types of INSERT statements are handled, with the regular INSERT directly entering the insertOneRow.\nBefore discussing insertOneRow, let’s look at a piece of SQL.\nCREATE TABLE t (i INT UNIQUE); INSERT INTO t VALUES (1); BEGIN; INSERT INTO t VALUES (1); COMMIT; Execute this SQL line by line in both TiDB and MySQL to see the results.\nMySQL:\nmysql\u003e CREATE TABLE t (i INT UNIQUE); Query OK, 0 rows affected (0.15 sec) mysql\u003e INSERT INTO t VALUES (1); Query OK, 1 row affected (0.01 sec) mysql\u003e BEGIN; Query OK, 0 rows affected (0.00 sec) mysql\u003e INSERT INTO t VALUES (1); ERROR 1062 (23000): Duplicate entry '1' for key 'i' mysql\u003e COMMIT; Query OK, 0 rows affected (0.11 sec) TiDB:\nmysql\u003e CREATE TABLE t (i INT UNIQUE); Query OK, 0 rows affected (1.04 sec) mysql\u003e INSERT INTO t VALUES (1); Query OK, 1 row affected (0.12 sec) mysql\u003e BEGIN; Query OK, 0 rows affected (0.01 sec) mysql\u003e INSERT INTO t VALUES (1); Query OK, 1 row affected (0.00 sec) mysql\u003e COMMIT; ERROR 1062 (23000): Duplicate entry '1' for key 'i' As can be seen, for the INSERT statement, TiDB performs conflict detection at the time of transaction commitment, while MySQL performs the detection when the statement is executed. This is because in insertOneRow, the PresumeKeyNotExists option is set, meaning all INSERTs initially assume that no conflicts will occur, and conflict detection is deferred to the commitment phase to perform a bulk check on all rows inserted in the transaction.\nINSERT IGNORE Statement The semantics of INSERT IGNORE have been introduced earlier. Since usual INSERTs are checked for conflicts at commitment, can INSERT IGNORE follow this approach as well? The answer is no, due to the following reasons:\nIf INSERT IGNORE checks for conflicts at commitment, the transaction module would need to know which rows to ignore and which rows to error and rollback, greatly increasing module coupling. Users expect to immediately see which rows were not inserted under INSERT IGNORE. That is, they want to immediately use SHOW WARNINGS to know which rows were not actually written. This requires immediate conflict detection when executing INSERT IGNORE. An obvious approach would be to try reading out the data before insertion, log a warning upon discovering a conflict, and then proceed to the next row. However, for situations where multiple rows are inserted in one statement, it would repeatedly read data from TiKV for detection. Therefore, TiDB implements batchChecker, with code located in executor/batch_checker.go.\nIn batchChecker:\nFirst, the unique constraints that could potentially conflict with the data to be inserted are constructed into keys via getKeysNeedCheck (TiDB uses unique keys to enforce uniqueness constraints, detailed in “Three Articles to Understand the Technical Inside Story of TiDB - Computation”), and the constructed keys are read together via BatchGetValues, fetching only the conflicting data.\nThen, the keys of the data to be inserted are checked against the results from BatchGetValues. Rows found to be in conflict will have a warning constructed, before moving on to the next row. Rows without conflict can be safely INSERTed. This process is implemented in batchCheckAndInsert.\n","wordCount":"1012","inLanguage":"en","datePublished":"2018-07-11T14:18:00+08:00","dateModified":"2018-07-11T14:18:00+08:00","author":{"@type":"Person","name":"Jack Yu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.minifish.org/posts/insert-opt/"},"publisher":{"@type":"Organization","name":"Mini Fish","logo":{"@type":"ImageObject","url":"https://blog.minifish.org/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.minifish.org/ accesskey=h title="Mini Fish (Alt + H)">Mini Fish</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.minifish.org/>Home</a>&nbsp;»&nbsp;<a href=https://blog.minifish.org/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">How TiDB Implements the INSERT Statement</h1><div class=post-meta><span title='2018-07-11 14:18:00 +0800 +0800'>July 11, 2018</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;1012 words&nbsp;·&nbsp;Jack Yu&nbsp;|&nbsp;<a href=https://github.com/jackysp/blog/tree/master/content/posts/insert-opt.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#types-of-insert-statements>Types of INSERT Statements</a></li><li><a href=#insert-statement>INSERT Statement</a></li><li><a href=#insert-ignore-statement>INSERT IGNORE Statement</a></li></ul></nav></div></details></div><div class=post-content><p>In the previous article <a href=https://zhuanlan.zhihu.com/p/34512827>&ldquo;Overview of the Insert Statement&rdquo;</a>, the general process of the INSERT statement was introduced. This article will explain in detail the implementation of several types of INSERT statements in TiDB.</p><h2 id=types-of-insert-statements>Types of INSERT Statements<a hidden class=anchor aria-hidden=true href=#types-of-insert-statements>#</a></h2><p>In TiDB, there are the following types of INSERT statements:</p><ul><li>INSERT</li><li>INSERT IGNORE</li><li>INSERT ON DUPLICATE KEY UPDATE</li><li>INSERT IGNORE ON DUPLICATE KEY UPDATE</li><li>REPLACE</li><li>LOAD DATA</li></ul><p>These six statements theoretically fall under the category of INSERT statements.</p><p>The first type is the most common INSERT statement, which needs no further explanation.</p><p>The second type, INSERT IGNORE, skips the current row when encountering a unique constraint conflict (primary key conflict, unique index conflict) and logs a warning. After the execution of the statement, you can see which rows were not inserted through <code>SHOW WARNINGS</code>.</p><p>The third type, INSERT ON DUPLICATE KEY UPDATE, updates the conflicting row and then inserts the data. If the updated row conflicts with another row in the table, an error is returned.</p><p>The fourth type, INSERT IGNORE ON DUPLICATE KEY UPDATE, does not insert the row and displays a warning when the updated row conflicts with another row after the initial conflict.</p><p>The fifth type, REPLACE, deletes the conflicting row from the table and continues trying to insert data. If another conflict occurs, it continues deleting the conflicting data until there is no more conflicting data in the table, then inserts the data.</p><p>The last type, LOAD DATA, follows the same rule as INSERT IGNORE—it ignores conflicts. However, LOAD DATA&rsquo;s purpose is to import data from a file into a table, meaning the data comes from a CSV data file.</p><p>This article mainly focuses on the source code implementation of the first and second types (INSERT, INSERT IGNORE), while the third and fifth types (INSERT ON DUPLICATE KEY UPDATE, REPLACE) will be introduced later. INSERT IGNORE ON DUPLICATE KEY UPDATE involves some special handling on top of INSERT ON DUPLICATE KEY UPDATE, and LOAD DATA is a special implementation of INSERT IGNORE, so they will not be detailed here.</p><h2 id=insert-statement>INSERT Statement<a hidden class=anchor aria-hidden=true href=#insert-statement>#</a></h2><p>The major difference between these various INSERT statements lies in the execution layer. We will continue with the explanation from <a href=https://zhuanlan.zhihu.com/p/34512827>&ldquo;Overview of the Insert Statement&rdquo;</a>. If you don’t remember the previous content, feel free to refer back to the original article.</p><p>The execution logic of INSERT is located in executor/insert.go. In fact, the execution logic of the first four INSERT types is all in this file. Let’s first discuss the most basic INSERT.</p><p>InsertExec is the executor implementation for INSERT, which implements the Executor interface. It performs some initialization in the Open method, executes in the Next method, and does some cleanup in the Close method.</p><p>In the Next method, based on whether the data is acquired through a SELECT statement (INSERT INTO &mldr; SELECT FROM), the Next process is divided into insertRows and insertRowsFromSelect. Both processes eventually enter the exec function to execute the INSERT.</p><p>Within the exec function, the first four types of INSERT statements are handled, with the regular INSERT directly entering the insertOneRow.</p><p>Before discussing insertOneRow, let&rsquo;s look at a piece of SQL.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> t (i INT <span style=color:#66d9ef>UNIQUE</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> t <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>BEGIN</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> t <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>COMMIT</span>;
</span></span></code></pre></div><p>Execute this SQL line by line in both TiDB and MySQL to see the results.</p><p>MySQL:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>mysql&gt; CREATE TABLE t (i INT UNIQUE);
</span></span><span style=display:flex><span>Query OK, 0 rows affected (0.15 sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; INSERT INTO t VALUES (1);
</span></span><span style=display:flex><span>Query OK, 1 row affected (0.01 sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; BEGIN;
</span></span><span style=display:flex><span>Query OK, 0 rows affected (0.00 sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; INSERT INTO t VALUES (1);
</span></span><span style=display:flex><span>ERROR 1062 (23000): Duplicate entry &#39;1&#39; for key &#39;i&#39;
</span></span><span style=display:flex><span>mysql&gt; COMMIT;
</span></span><span style=display:flex><span>Query OK, 0 rows affected (0.11 sec)
</span></span></code></pre></div><p>TiDB:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>mysql&gt; CREATE TABLE t (i INT UNIQUE);
</span></span><span style=display:flex><span>Query OK, 0 rows affected (1.04 sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; INSERT INTO t VALUES (1);
</span></span><span style=display:flex><span>Query OK, 1 row affected (0.12 sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; BEGIN;
</span></span><span style=display:flex><span>Query OK, 0 rows affected (0.01 sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; INSERT INTO t VALUES (1);
</span></span><span style=display:flex><span>Query OK, 1 row affected (0.00 sec)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mysql&gt; COMMIT;
</span></span><span style=display:flex><span>ERROR 1062 (23000): Duplicate entry &#39;1&#39; for key &#39;i&#39;
</span></span></code></pre></div><p>As can be seen, for the INSERT statement, TiDB performs conflict detection at the time of transaction commitment, while MySQL performs the detection when the statement is executed. This is because in insertOneRow, the PresumeKeyNotExists option is set, meaning all INSERTs initially assume that no conflicts will occur, and conflict detection is deferred to the commitment phase to perform a bulk check on all rows inserted in the transaction.</p><h2 id=insert-ignore-statement>INSERT IGNORE Statement<a hidden class=anchor aria-hidden=true href=#insert-ignore-statement>#</a></h2><p>The semantics of INSERT IGNORE have been introduced earlier. Since usual INSERTs are checked for conflicts at commitment, can INSERT IGNORE follow this approach as well? The answer is no, due to the following reasons:</p><ol><li>If INSERT IGNORE checks for conflicts at commitment, the transaction module would need to know which rows to ignore and which rows to error and rollback, greatly increasing module coupling.</li><li>Users expect to immediately see which rows were not inserted under INSERT IGNORE. That is, they want to immediately use <code>SHOW WARNINGS</code> to know which rows were not actually written.</li></ol><p>This requires immediate conflict detection when executing INSERT IGNORE. An obvious approach would be to try reading out the data before insertion, log a warning upon discovering a conflict, and then proceed to the next row. However, for situations where multiple rows are inserted in one statement, it would repeatedly read data from TiKV for detection. Therefore, TiDB implements batchChecker, with code located in executor/batch_checker.go.</p><p>In batchChecker:</p><p>First, the unique constraints that could potentially conflict with the data to be inserted are constructed into keys via getKeysNeedCheck (TiDB uses unique keys to enforce uniqueness constraints, detailed in <a href=https://zhuanlan.zhihu.com/p/27108657>&ldquo;Three Articles to Understand the Technical Inside Story of TiDB - Computation&rdquo;</a>), and the constructed keys are read together via BatchGetValues, fetching only the conflicting data.</p><p>Then, the keys of the data to be inserted are checked against the results from BatchGetValues. Rows found to be in conflict will have a warning constructed, before moving on to the next row. Rows without conflict can be safely INSERTed. This process is implemented in batchCheckAndInsert.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://blog.minifish.org/posts/golang-panic/><span class=title>« Prev</span><br><span>How Immediate is Golang's Panic</span>
</a><a class=next href=https://blog.minifish.org/posts/haproxy/><span class=title>Next »</span><br><span>How to Use HAProxy to Test CockroachDB</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share How TiDB Implements the INSERT Statement on x" href="https://x.com/intent/tweet/?text=How%20TiDB%20Implements%20the%20INSERT%20Statement&amp;url=https%3a%2f%2fblog.minifish.org%2fposts%2finsert-opt%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share How TiDB Implements the INSERT Statement on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.minifish.org%2fposts%2finsert-opt%2f&amp;title=How%20TiDB%20Implements%20the%20INSERT%20Statement&amp;summary=How%20TiDB%20Implements%20the%20INSERT%20Statement&amp;source=https%3a%2f%2fblog.minifish.org%2fposts%2finsert-opt%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share How TiDB Implements the INSERT Statement on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.minifish.org%2fposts%2finsert-opt%2f&title=How%20TiDB%20Implements%20the%20INSERT%20Statement"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share How TiDB Implements the INSERT Statement on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.minifish.org%2fposts%2finsert-opt%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share How TiDB Implements the INSERT Statement on whatsapp" href="https://api.whatsapp.com/send?text=How%20TiDB%20Implements%20the%20INSERT%20Statement%20-%20https%3a%2f%2fblog.minifish.org%2fposts%2finsert-opt%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share How TiDB Implements the INSERT Statement on telegram" href="https://telegram.me/share/url?text=How%20TiDB%20Implements%20the%20INSERT%20Statement&amp;url=https%3a%2f%2fblog.minifish.org%2fposts%2finsert-opt%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share How TiDB Implements the INSERT Statement on ycombinator" href="https://news.ycombinator.com/submitlink?t=How%20TiDB%20Implements%20the%20INSERT%20Statement&u=https%3a%2f%2fblog.minifish.org%2fposts%2finsert-opt%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://blog.minifish.org/>Mini Fish</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>